---
title: "Turtle cactus stats"
author: "[gwct](https://gwct.github.io/)"
date: "`r format(Sys.time(), '%m/%d/%Y %H:%M:%S %Z')`"
output:
  #html_document:
  rmdformats::robobook:
    highlight: kate
    includes:
      in_header: '../html-chunks/rmd_header.html'
    df_print: paged
    code_folding: hide 
    number_sections: true
    toc_depth: 3
---

```{r setup, warning=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

library(ggplot2)
library(cowplot)
library(ggbeeswarm)
library(dplyr)
library(chron)
library(kableExtra)
library(ggtree)
library(viridis)
source("../lib/design.r")
source("../lib/get_tree_info.r")
```

[< Back to samples](index.html)

Assemblies from each genome were downloaded from NCBI on 07.22.2021

```{r read-data}
in_data = read.csv("../../data/turtles-include-cactus.csv", header=T, comment.char="#")
# Read in the turtle data

in_data$mask.cputime = in_data$mask.cputime / 60 / 60
in_data$mask.runtime = in_data$mask.runtime / 60 / 60
in_data$mask.maxmem = substr(in_data$mask.maxmem,1,nchar(in_data$mask.maxmem)-1)
in_data$mask.maxmem= as.numeric(in_data$mask.maxmem)
in_data$mask.maxmem = in_data$mask.maxmem / 1024 / 1024

in_data$blast.cputime = in_data$blast.cputime / 60 / 60
in_data$blast.runtime = in_data$blast.runtime / 60 / 60
in_data$blast.maxmem = substr(in_data$blast.maxmem,1,nchar(in_data$blast.maxmem)-1)
in_data$blast.maxmem= as.numeric(in_data$blast.maxmem)
in_data$blast.maxmem = in_data$blast.maxmem / 1024 / 1024

in_data$align.cputime = in_data$align.cputime / 60 / 60
in_data$align.runtime = in_data$align.runtime / 60 / 60
in_data$align.maxmem = substr(in_data$align.maxmem,1,nchar(in_data$align.maxmem)-1)
in_data$align.maxmem= as.numeric(in_data$align.maxmem)
in_data$align.maxmem = in_data$align.maxmem / 1024 / 1024

in_data$convert.cputime = in_data$convert.cputime / 60 / 60
in_data$convert.runtime = in_data$convert.runtime / 60 / 60
in_data$convert.maxmem = substr(in_data$convert.maxmem,1,nchar(in_data$convert.maxmem)-1)
in_data$convert.maxmem= as.numeric(in_data$convert.maxmem)
in_data$convert.maxmem = in_data$convert.maxmem / 1024 / 1024

genome_data = select(in_data, clade, Scaffolds, Scaffold.N50)

###############

mut_data = read.csv("../../data/cactus-summarize-mutations.csv")
names(mut_data)[1] = "label"
mut_data = subset(mut_data, label != "Total" & label != "Average")

cactus_tree = read.tree(file="../../data/tree/turtle-tree-cactus.tre")
tree_to_df_list = treeToDF(cactus_tree)
cactus_tree_info = tree_to_df_list[["info"]]

cactus_tree_info = merge(cactus_tree_info, mut_data, by="label")

cactus_tree_info = merge(cactus_tree_info, genome_data, by="clade")

cactus_tree_info = cactus_tree_info[order(cactus_tree_info$node), ]
# Re-sort the data frame by R node order after the merge so the trees still work

```

# Resource summary

## Requested resources per job

```{r req-resources, out.width="66%", fig.align="center"}

resources = data.frame("Step"=c("Mask", "Blast", "Align", "Convert"), 
                       "Partition"=c("gpu", "gpu", "bigmem", "shared"), 
                       "Memory"=c("100g", "400g", "450g", "12g"), 
                       "CPUs"=c("64", "64", "64", "8"), 
                       "GPUs"=c("4", "4", "NA", "NA"), 
                       "Time"=c("2h", "48h", "48h", "4h"))


resources %>% kable() %>% kable_styling(bootstrap_options=c("striped", "condended", "responsive"), full_width=F)
# Display calibration points as a table
```

[< Back to samples](index.html)

## Runtime summaries

Masking steps for tips take less than 15 minutes.

Converting HAL to FASTA takes only 30 seconds.

```{r runtime-fig, out.width="66%", fig.align="center", fig.height=3.5}

mask = select(in_data, cactus.node, mask.runtime, mask.time)
names(mask)[2] = "time"
names(mask)[3] = "req.time"
mask$step = "Mask"

blast = select(in_data, cactus.node, blast.runtime, blast.time)
names(blast)[2] = "time"
names(blast)[3] = "req.time"
blast$step = "Blast"

align = select(in_data, cactus.node, align.runtime, align.time)
names(align)[2] = "time"
names(align)[3] = "req.time"
align$step = "Align"

time_data = rbind(blast, align)
time_data$perc.time = time_data$time / time_data$req.time
#time_data$time = chron(time=time_data$time)

#time_data$hours = hours(time_data$time) + minutes(time_data$time) / 60 + seconds(time_data$time) / 60 / 60

time_data$step = factor(time_data$step, levels=c("Blast", "Align"))

time_p = ggplot(data=time_data, aes(x=step, y=time, group=step)) +
  geom_quasirandom(size=3, width=0.25, alpha=0.40, color=corecol(numcol=1)) +
  geom_boxplot(outlier.shape=NA, alpha=0.15, width=0.5, color="#666666") +
  xlab("Cactus step") +
  ylab("Time (hours)") +
  bartheme()
#print(time_p)
# Display the figure

time_perc_p = ggplot(data=time_data, aes(x=step, y=perc.time, group=step)) +
  geom_quasirandom(size=3, width=0.25, alpha=0.40, color=corecol(numcol=1)) +
  geom_boxplot(outlier.shape=NA, alpha=0.15, width=0.5, color="#666666") +
  xlab("Cactus step") +
  ylab("% of requested\ntime used") +
  scale_y_continuous(limits=c(0,1)) +
  bartheme()
#print(time_perc_p)
# Display the figure

p = plot_grid(time_p, time_perc_p, ncol=2)
print(p)

```
[< Back to samples](index.html)

## CPU time summaries

```{r cputime-fig, out.width="40%", fig.align="center", fig.height=4}

mask = select(in_data, cactus.node, mask.cputime, mask.time)
names(mask)[2] = "time"
names(mask)[3] = "req.time"
mask$step = "Mask"

blast = select(in_data, cactus.node, blast.cputime, blast.time)
names(blast)[2] = "time"
names(blast)[3] = "req.time"
blast$step = "Blast"

align = select(in_data, cactus.node, align.cputime, align.time)
names(align)[2] = "time"
names(align)[3] = "req.time"
align$step = "Align"

convert = select(in_data, cactus.node, convert.cputime, convert.time)
names(convert)[2] = "time"
names(convert)[3] = "req.time"
convert$step = "Convert"

time_data = rbind(mask, blast, align, convert)
time_data$perc.time = time_data$time / time_data$req.time
#time_data$time = chron(time=time_data$time)

#time_data$hours = hours(time_data$time) + minutes(time_data$time) / 60 + seconds(time_data$time) / 60 / 60

time_data$step = factor(time_data$step, levels=c("Mask", "Blast", "Align", "Convert"))

time_p = ggplot(data=time_data, aes(x=step, y=time, group=step)) +
  geom_quasirandom(size=3, width=0.25, alpha=0.40, color=corecol(numcol=1, offset=1)) +
  geom_boxplot(outlier.shape=NA, alpha=0.15, width=0.5, color="#666666") +
  xlab("Cactus step") +
  ylab("CPU Time (hours)") +
  bartheme()
print(time_p)
# Display the figure

```

[< Back to samples](index.html)

## Max memory summaries

```{r maxmem-fig, out.width="66%", fig.align="center", fig.height=3.5}

mask = select(in_data, cactus.node, mask.maxmem, mask.mem)
names(mask)[2] = "maxmem"
names(mask)[3] = "req.mem"
mask$step = "Mask"

blast = select(in_data, cactus.node, blast.maxmem, blast.mem)
names(blast)[2] = "maxmem"
names(blast)[3] = "req.mem"
blast$step = "Blast"

align = select(in_data, cactus.node, align.maxmem, align.mem)
names(align)[2] = "maxmem"
names(align)[3] = "req.mem"
align$step = "Align"

convert = select(in_data, cactus.node, convert.maxmem, convert.mem)
names(convert)[2] = "maxmem"
names(convert)[3] = "req.mem"
convert$step = "Convert"

mem_data = rbind(mask, blast, align, convert)
mem_data$perc.mem = mem_data$maxmem / mem_data$req.mem
#time_data$time = chron(time=time_data$time)

#time_data$hours = hours(time_data$time) + minutes(time_data$time) / 60 + seconds(time_data$time) / 60 / 60

mem_data$step = factor(mem_data$step, levels=c("Mask", "Blast", "Align", "Convert"))

mem_p = ggplot(data=mem_data, aes(x=step, y=maxmem, group=step)) +
  geom_quasirandom(size=3, width=0.25, alpha=0.40, color=corecol(numcol=1, offset=2)) +
  geom_boxplot(outlier.shape=NA, alpha=0.15, width=0.5, color="#666666") +
  xlab("Cactus step") +
  ylab("Max memory used (Mb)") +
  bartheme()
#print(mem_p)
# Display the figure

mem_perc_p = ggplot(data=mem_data, aes(x=step, y=perc.mem, group=step)) +
  geom_quasirandom(size=3, width=0.25, alpha=0.40, color=corecol(numcol=1, offset=2)) +
  geom_boxplot(outlier.shape=NA, alpha=0.15, width=0.5, color="#666666") +
  xlab("Cactus step") +
  ylab("% of requested memory\nused at max") +
  scale_y_continuous(limits=c(0,1)) +
  bartheme()
#print(mem_perc_p)
# Display the figure

p = plot_grid(mem_p, mem_perc_p, ncol=2)
print(p)

```

# Mutation summary

## Substitutions per site

```{r substitutions, out.width="90%", fig.align = "center", warning=FALSE, fig.height=5}
rotateTurtleTree <- function(turtle_tree) {
  turtle_tree = ggtree::rotate(turtle_tree, 43)
  turtle_tree = ggtree::rotate(turtle_tree, 42)
  turtle_tree = ggtree::rotate(turtle_tree, 24)
  turtle_tree = ggtree::rotate(turtle_tree, 25)
  turtle_tree = ggtree::rotate(turtle_tree, 26)
  turtle_tree = ggtree::rotate(turtle_tree, 27)
  turtle_tree = ggtree::rotate(turtle_tree, 40)
  turtle_tree = ggtree::rotate(turtle_tree, 38)
  turtle_tree = ggtree::rotate(turtle_tree, 35)
  turtle_tree = ggtree::rotate(turtle_tree, 29)
  turtle_tree = ggtree::rotate(turtle_tree, 30)
  turtle_tree = ggtree::rotate(turtle_tree, 31)
  turtle_tree = ggtree::rotate(turtle_tree, 32)

  return(turtle_tree)
}

h = corecol(numcol=1, pal="wilke", offset=3)
l = corecol(numcol=1, offset=3)
# Colors

famcol = corecol(pal="trek", numcol=1, offset=2)
famoffset = 0.0275
famsize = 2

cactus_tree_info$subs.per.site = cactus_tree_info$Subtitutions / cactus_tree_info$GenomeLength

tree_fig = ggtree(cactus_tree, size=0.8, ladderize=F, aes(color=cactus_tree_info$subs.per.site)) +
  #scale_color_continuous(low=l, high=h) +
  scale_color_viridis(name='Substitutions\nper site', option = "C") +
  xlim(0, 0.25) +
  geom_tiplab(fontface='italic', size=2) +
  geom_text(label=ifelse(cactus_tree_info$node.type != "tip", cactus_tree_info$label, ""), hjust=-0.2, size=2) +
  geom_nodepoint(alpha=0.85, size=2) +
  #scale_color_manual(name='Include?', values=c("N"=corecol(pal="wilke", numcol=1,offset=1), "Y"=corecol(numcol=1, offset=1))) +
  #geom_text(aes(label=node), hjust=-.3, vjust=-.3, color="#ff6db6") +
  
  geom_cladelabel(node=21, label="Podocnemididae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=22, label="Pelomedusidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=42, label="Chelidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=3,  label="Carettochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=26, label="Trionychidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=18, label="Dermochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=40, label="Cheloniidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=14, label="Chelydridae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=15, label="Dermatemydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=13, label="Platysternidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=34, label="Emydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=30, label="Testudinidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=31, label="Geomydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  
  theme(legend.position="bottom",
        legend.title=element_text(size=10),
        legend.text=element_text(size=8))

tree_fig = rotateTurtleTree(tree_fig)

bl_cor = ggplot(cactus_tree_info, aes(x=BranchLength, y=subs.per.site, color=subs.per.site)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Substitutions\nper site', option = "C") +
  xlab("Branch length") +
  ylab("Substitutions\nper site") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(bl_cor)

scaff_cor = ggplot(cactus_tree_info, aes(x=Scaffolds, y=subs.per.site, color=subs.per.site)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Substitutions\nper site', option = "C") +
  xlab("# Scaffolds") +
  ylab("Substitutions\nper site") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(scaff_cor)

n50_cor = ggplot(cactus_tree_info, aes(x=Scaffold.N50, y=subs.per.site, color=subs.per.site)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Substitutions\nper site', option = "C") +
  xlab("Scaffold N50") +
  ylab("Substitutions\nper site") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(n50_cor)

tree_leg = get_legend(tree_fig)

p_right = plot_grid(bl_cor, scaff_cor, n50_cor, nrow=3)
p_top = plot_grid(tree_fig + theme(legend.position="none"), p_right , ncol=2, rel_widths=c(1,0.8))
p = plot_grid(p_top, tree_leg, nrow=2, rel_heights=c(1,0.1))


# p_right = plot_grid(NULL, bl_cor, NULL, nrow=3, rel_heights=c(0.1,1,0.1))
# p_top = plot_grid(tree_fig + theme(legend.position="none"), p_right , ncol=2)
# p_bot = plot_grid(scaff_cor, n50_cor, ncol=2)
# p_noleg = plot_grid(p_top, p_bot, nrow=2, rel_heights=c(1, 0.8))
# p = plot_grid(p_noleg, tree_leg, nrow=2, rel_heights=c(1,0.1))


# p_top = plot_grid(NULL, tree_fig, NULL, ncol=3, rel_heights=c(0.2,1,0.2))
# p_bot = plot_grid(bl_cor, scaff_cor, n50_cor, ncol=3)
# p = plot_grid(p_top, p_bot, nrow=2, rel_heights=c(1,0.5))

# p_right = plot_grid(bl_cor, scaff_cor, n50_cor, nrow=3)
# 
# p = plot_grid(p_top, tree_leg, nrow=2, rel_heights=c(1,0.1))
print(p)
```

## Insertions

```{r insertions, out.width="90%", fig.align = "center", warning=FALSE, fig.height=5}

h = corecol(numcol=1, pal="wilke", offset=3)
l = corecol(numcol=1, offset=3)
# Colors

famcol = corecol(pal="trek", numcol=1, offset=2)
famoffset = 0.0275
famsize = 2

#cactus_tree_info$subs.per.site = cactus_tree_info$Subtitutions / cactus_tree_info$GenomeLength

tree_fig = ggtree(cactus_tree, size=0.8, ladderize=F, aes(color=cactus_tree_info$Insertions)) +
  #scale_color_continuous(low=l, high=h) +
  scale_color_viridis(name='Insertions', option = "C") +
  xlim(0, 0.25) +
  geom_tiplab(fontface='italic', size=2) +
  geom_text(label=ifelse(cactus_tree_info$node.type != "tip", cactus_tree_info$label, ""), hjust=-0.2, size=2) +
  geom_nodepoint(alpha=0.85, size=2) +
  #scale_color_manual(name='Include?', values=c("N"=corecol(pal="wilke", numcol=1,offset=1), "Y"=corecol(numcol=1, offset=1))) +
  #geom_text(aes(label=node), hjust=-.3, vjust=-.3, color="#ff6db6") +
  
  geom_cladelabel(node=21, label="Podocnemididae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=22, label="Pelomedusidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=42, label="Chelidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=3,  label="Carettochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=26, label="Trionychidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=18, label="Dermochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=40, label="Cheloniidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=14, label="Chelydridae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=15, label="Dermatemydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=13, label="Platysternidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=34, label="Emydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=30, label="Testudinidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=31, label="Geomydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  
  theme(legend.position="bottom",
        legend.title=element_text(size=10),
        legend.text=element_text(size=8))

tree_fig = rotateTurtleTree(tree_fig)

bl_cor = ggplot(cactus_tree_info, aes(x=BranchLength, y=Insertions, color=Insertions)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Insertions', option = "C") +
  xlab("Branch length") +
  ylab("Insertions") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(bl_cor)

scaff_cor = ggplot(cactus_tree_info, aes(x=Scaffolds, y=Insertions, color=Insertions)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Insertions', option = "C") +
  xlab("# Scaffolds") +
  ylab("Insertions") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(scaff_cor)

n50_cor = ggplot(cactus_tree_info, aes(x=Scaffold.N50, y=Insertions, color=Insertions)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Insertions', option = "C") +
  xlab("Scaffold N50") +
  ylab("Insertions") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(n50_cor)

tree_leg = get_legend(tree_fig)

p_right = plot_grid(bl_cor, scaff_cor, n50_cor, nrow=3)
p_top = plot_grid(tree_fig + theme(legend.position="none"), p_right , ncol=2, rel_widths=c(1,0.8))
p = plot_grid(p_top, tree_leg, nrow=2, rel_heights=c(1,0.1))

# tree_leg = get_legend(tree_fig)
# 
# p_top = plot_grid(NULL, bl_cor, tree_leg, nrow=3, rel_heights=c(0.2,1,0.3))
# p = plot_grid(tree_fig + theme(legend.position="none"), p_top, ncol=2)
print(p)
```

## Inserted bases

```{r inserted-bases, out.width="90%", fig.align = "center", warning=FALSE, fig.height=5}

h = corecol(numcol=1, pal="wilke", offset=3)
l = corecol(numcol=1, offset=3)
# Colors

famcol = corecol(pal="trek", numcol=1, offset=2)
famoffset = 0.0275
famsize = 2

#cactus_tree_info$subs.per.site = cactus_tree_info$Subtitutions / cactus_tree_info$GenomeLength

tree_fig = ggtree(cactus_tree, size=0.8, ladderize=F, aes(color=cactus_tree_info$InsertionBases)) +
  #scale_color_continuous(low=l, high=h) +
  scale_color_viridis(name='Insertions', option = "C") +
  xlim(0, 0.25) +
  geom_tiplab(fontface='italic', size=2) +
  geom_text(label=ifelse(cactus_tree_info$node.type != "tip", cactus_tree_info$label, ""), hjust=-0.2, size=2) +
  geom_nodepoint(alpha=0.85, size=2) +
  #scale_color_manual(name='Include?', values=c("N"=corecol(pal="wilke", numcol=1,offset=1), "Y"=corecol(numcol=1, offset=1))) +
  #geom_text(aes(label=node), hjust=-.3, vjust=-.3, color="#ff6db6") +
  
  geom_cladelabel(node=21, label="Podocnemididae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=22, label="Pelomedusidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=42, label="Chelidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=3,  label="Carettochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=26, label="Trionychidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=18, label="Dermochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=40, label="Cheloniidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=14, label="Chelydridae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=15, label="Dermatemydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=13, label="Platysternidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=34, label="Emydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=30, label="Testudinidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=31, label="Geomydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  
  theme(legend.position="bottom",
        legend.title=element_text(size=10),
        legend.text=element_text(size=8))

tree_fig = rotateTurtleTree(tree_fig)

bl_cor = ggplot(cactus_tree_info, aes(x=BranchLength, y=InsertionBases, color=InsertionBases)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Inserted bases', option = "C") +
  xlab("Branch length") +
  ylab("Inserted bases") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(bl_cor)

scaff_cor = ggplot(cactus_tree_info, aes(x=Scaffolds, y=InsertionBases, color=InsertionBases)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Inserted bases', option = "C") +
  xlab("# Scaffolds") +
  ylab("Inserted bases") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(scaff_cor)

n50_cor = ggplot(cactus_tree_info, aes(x=Scaffold.N50, y=InsertionBases, color=InsertionBases)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Inserted bases', option = "C") +
  xlab("Scaffold N50") +
  ylab("Inserted bases") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(n50_cor)

tree_leg = get_legend(tree_fig)

p_right = plot_grid(bl_cor, scaff_cor, n50_cor, nrow=3)
p_top = plot_grid(tree_fig + theme(legend.position="none"), p_right , ncol=2, rel_widths=c(1,0.8))
p = plot_grid(p_top, tree_leg, nrow=2, rel_heights=c(1,0.1))

# tree_leg = get_legend(tree_fig)
# 
# p_top = plot_grid(NULL, bl_cor, tree_leg, nrow=3, rel_heights=c(0.2,1,0.3))
# p = plot_grid(tree_fig + theme(legend.position="none"), p_top, ncol=2)
print(p)
```


## Deletions

```{r deletions, out.width="90%", fig.align = "center", warning=FALSE, fig.height=5}

h = corecol(numcol=1, pal="wilke", offset=3)
l = corecol(numcol=1, offset=3)
# Colors

famcol = corecol(pal="trek", numcol=1, offset=2)
famoffset = 0.0275
famsize = 2

#cactus_tree_info$subs.per.site = cactus_tree_info$Subtitutions / cactus_tree_info$GenomeLength

tree_fig = ggtree(cactus_tree, size=0.8, ladderize=F, aes(color=cactus_tree_info$Deletions)) +
  #scale_color_continuous(low=l, high=h) +
  scale_color_viridis(name='Deletions', option = "C") +
  xlim(0, 0.25) +
  geom_tiplab(fontface='italic', size=2) +
  geom_text(label=ifelse(cactus_tree_info$node.type != "tip", cactus_tree_info$label, ""), hjust=-0.2, size=2) +
  geom_nodepoint(alpha=0.85, size=2) +
  #scale_color_manual(name='Include?', values=c("N"=corecol(pal="wilke", numcol=1,offset=1), "Y"=corecol(numcol=1, offset=1))) +
  #geom_text(aes(label=node), hjust=-.3, vjust=-.3, color="#ff6db6") +
  
  geom_cladelabel(node=21, label="Podocnemididae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=22, label="Pelomedusidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=42, label="Chelidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=3,  label="Carettochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=26, label="Trionychidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=18, label="Dermochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=40, label="Cheloniidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=14, label="Chelydridae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=15, label="Dermatemydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=13, label="Platysternidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=34, label="Emydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=30, label="Testudinidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=31, label="Geomydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  
  theme(legend.position="bottom",
        legend.title=element_text(size=10),
        legend.text=element_text(size=8))

tree_fig = rotateTurtleTree(tree_fig)

bl_cor = ggplot(cactus_tree_info, aes(x=BranchLength, y=Deletions, color=Deletions)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Deletions', option = "C") +
  xlab("Branch length") +
  ylab("Deletions") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(bl_cor)

scaff_cor = ggplot(cactus_tree_info, aes(x=Scaffolds, y=Deletions, color=Deletions)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Deletions', option = "C") +
  xlab("# Scaffolds") +
  ylab("Deletions") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(scaff_cor)

n50_cor = ggplot(cactus_tree_info, aes(x=Scaffold.N50, y=Deletions, color=Deletions)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Deletions', option = "C") +
  xlab("Scaffold N50") +
  ylab("Deletions") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(n50_cor)

tree_leg = get_legend(tree_fig)

p_right = plot_grid(bl_cor, scaff_cor, n50_cor, nrow=3)
p_top = plot_grid(tree_fig + theme(legend.position="none"), p_right , ncol=2, rel_widths=c(1,0.8))
p = plot_grid(p_top, tree_leg, nrow=2, rel_heights=c(1,0.1))

# tree_leg = get_legend(tree_fig)
# 
# p_top = plot_grid(NULL, bl_cor, tree_leg, nrow=3, rel_heights=c(0.2,1,0.3))
# p = plot_grid(tree_fig + theme(legend.position="none"), p_top, ncol=2)
print(p)
```

## Deleted bases

```{r deleted-bases, out.width="90%", fig.align = "center", warning=FALSE, fig.height=5}

h = corecol(numcol=1, pal="wilke", offset=3)
l = corecol(numcol=1, offset=3)
# Colors

famcol = corecol(pal="trek", numcol=1, offset=2)
famoffset = 0.0275
famsize = 2

#cactus_tree_info$subs.per.site = cactus_tree_info$Subtitutions / cactus_tree_info$GenomeLength

tree_fig = ggtree(cactus_tree, size=0.8, ladderize=F, aes(color=cactus_tree_info$DeletionBases)) +
  #scale_color_continuous(low=l, high=h) +
  scale_color_viridis(name='Deleted bases', option = "C") +
  xlim(0, 0.25) +
  geom_tiplab(fontface='italic', size=2) +
  geom_text(label=ifelse(cactus_tree_info$node.type != "tip", cactus_tree_info$label, ""), hjust=-0.2, size=2) +
  geom_nodepoint(alpha=0.85, size=2) +
  #scale_color_manual(name='Include?', values=c("N"=corecol(pal="wilke", numcol=1,offset=1), "Y"=corecol(numcol=1, offset=1))) +
  #geom_text(aes(label=node), hjust=-.3, vjust=-.3, color="#ff6db6") +
  
  geom_cladelabel(node=21, label="Podocnemididae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=22, label="Pelomedusidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=42, label="Chelidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=3,  label="Carettochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=26, label="Trionychidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=18, label="Dermochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=40, label="Cheloniidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=14, label="Chelydridae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=15, label="Dermatemydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=13, label="Platysternidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=34, label="Emydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=30, label="Testudinidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=31, label="Geomydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  
  theme(legend.position="bottom",
        legend.title=element_text(size=10),
        legend.text=element_text(size=8))

tree_fig = rotateTurtleTree(tree_fig)

bl_cor = ggplot(cactus_tree_info, aes(x=BranchLength, y=DeletionBases, color=DeletionBases)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Deleted bases', option = "C") +
  xlab("Branch length") +
  ylab("Deleted bases") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(bl_cor)

scaff_cor = ggplot(cactus_tree_info, aes(x=Scaffolds, y=DeletionBases, color=DeletionBases)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Deleted bases', option = "C") +
  xlab("# Scaffolds") +
  ylab("Deleted bases") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(scaff_cor)

n50_cor = ggplot(cactus_tree_info, aes(x=Scaffold.N50, y=DeletionBases, color=DeletionBases)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Deleted bases', option = "C") +
  xlab("Scaffold N50") +
  ylab("Deleted bases") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(n50_cor)

tree_leg = get_legend(tree_fig)

p_right = plot_grid(bl_cor, scaff_cor, n50_cor, nrow=3)
p_top = plot_grid(tree_fig + theme(legend.position="none"), p_right , ncol=2, rel_widths=c(1,0.8))
p = plot_grid(p_top, tree_leg, nrow=2, rel_heights=c(1,0.1))

# tree_leg = get_legend(tree_fig)
# 
# p_top = plot_grid(NULL, bl_cor, tree_leg, nrow=3, rel_heights=c(0.2,1,0.3))
# p = plot_grid(tree_fig + theme(legend.position="none"), p_top, ncol=2)
print(p)
```

## Inversions

```{r inversions, out.width="90%", fig.align = "center", warning=FALSE, fig.height=5}

h = corecol(numcol=1, pal="wilke", offset=3)
l = corecol(numcol=1, offset=3)
# Colors

famcol = corecol(pal="trek", numcol=1, offset=2)
famoffset = 0.0275
famsize = 2

#cactus_tree_info$subs.per.site = cactus_tree_info$Subtitutions / cactus_tree_info$GenomeLength

tree_fig = ggtree(cactus_tree, size=0.8, ladderize=F, aes(color=cactus_tree_info$Inversions)) +
  #scale_color_continuous(low=l, high=h) +
  scale_color_viridis(name='Inversions', option = "C") +
  xlim(0, 0.25) +
  geom_tiplab(fontface='italic', size=2) +
  geom_text(label=ifelse(cactus_tree_info$node.type != "tip", cactus_tree_info$label, ""), hjust=-0.2, size=2) +
  geom_nodepoint(alpha=0.85, size=2) +
  #scale_color_manual(name='Include?', values=c("N"=corecol(pal="wilke", numcol=1,offset=1), "Y"=corecol(numcol=1, offset=1))) +
  #geom_text(aes(label=node), hjust=-.3, vjust=-.3, color="#ff6db6") +
  
  geom_cladelabel(node=21, label="Podocnemididae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=22, label="Pelomedusidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=42, label="Chelidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=3,  label="Carettochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=26, label="Trionychidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=18, label="Dermochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=40, label="Cheloniidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=14, label="Chelydridae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=15, label="Dermatemydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=13, label="Platysternidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=34, label="Emydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=30, label="Testudinidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=31, label="Geomydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  
  theme(legend.position="bottom",
        legend.title=element_text(size=10),
        legend.text=element_text(size=8))

tree_fig = rotateTurtleTree(tree_fig)

bl_cor = ggplot(cactus_tree_info, aes(x=BranchLength, y=Inversions, color=Inversions)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Inversions', option = "C") +
  xlab("Branch length") +
  ylab("Inversions") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(bl_cor)

scaff_cor = ggplot(cactus_tree_info, aes(x=Scaffolds, y=Inversions, color=Inversions)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Inversions', option = "C") +
  xlab("# Scaffolds") +
  ylab("Inversions") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(scaff_cor)

n50_cor = ggplot(cactus_tree_info, aes(x=Scaffold.N50, y=Inversions, color=Inversions)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Inversions', option = "C") +
  xlab("Scaffold N50") +
  ylab("Inversions") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(n50_cor)

tree_leg = get_legend(tree_fig)

p_right = plot_grid(bl_cor, scaff_cor, n50_cor, nrow=3)
p_top = plot_grid(tree_fig + theme(legend.position="none"), p_right , ncol=2, rel_widths=c(1,0.8))
p = plot_grid(p_top, tree_leg, nrow=2, rel_heights=c(1,0.1))

# tree_leg = get_legend(tree_fig)
# 
# p_top = plot_grid(NULL, bl_cor, tree_leg, nrow=3, rel_heights=c(0.2,1,0.3))
# p = plot_grid(tree_fig + theme(legend.position="none"), p_top, ncol=2)
print(p)
```

## Inverted bases

```{r inverted-bases, out.width="90%", fig.align = "center", warning=FALSE, fig.height=5}

h = corecol(numcol=1, pal="wilke", offset=3)
l = corecol(numcol=1, offset=3)
# Colors

famcol = corecol(pal="trek", numcol=1, offset=2)
famoffset = 0.0275
famsize = 2

#cactus_tree_info$subs.per.site = cactus_tree_info$Subtitutions / cactus_tree_info$GenomeLength

tree_fig = ggtree(cactus_tree, size=0.8, ladderize=F, aes(color=cactus_tree_info$InvertedBases)) +
  #scale_color_continuous(low=l, high=h) +
  scale_color_viridis(name='Inverted bases', option = "C") +
  xlim(0, 0.25) +
  geom_tiplab(fontface='italic', size=2) +
  geom_text(label=ifelse(cactus_tree_info$node.type != "tip", cactus_tree_info$label, ""), hjust=-0.2, size=2) +
  geom_nodepoint(alpha=0.85, size=2) +
  #scale_color_manual(name='Include?', values=c("N"=corecol(pal="wilke", numcol=1,offset=1), "Y"=corecol(numcol=1, offset=1))) +
  #geom_text(aes(label=node), hjust=-.3, vjust=-.3, color="#ff6db6") +
  
  geom_cladelabel(node=21, label="Podocnemididae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=22, label="Pelomedusidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=42, label="Chelidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=3,  label="Carettochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=26, label="Trionychidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=18, label="Dermochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=40, label="Cheloniidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=14, label="Chelydridae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=15, label="Dermatemydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=13, label="Platysternidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=34, label="Emydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=30, label="Testudinidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=31, label="Geomydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  
  theme(legend.position="bottom",
        legend.title=element_text(size=10),
        legend.text=element_text(size=8))

tree_fig = rotateTurtleTree(tree_fig)

bl_cor = ggplot(cactus_tree_info, aes(x=BranchLength, y=InvertedBases, color=InvertedBases)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Inverted bases', option = "C") +
  xlab("Branch length") +
  ylab("Inverted bases") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(bl_cor)

scaff_cor = ggplot(cactus_tree_info, aes(x=Scaffolds, y=InvertedBases, color=InvertedBases)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Inverted bases', option = "C") +
  xlab("# Scaffolds") +
  ylab("Inverted bases") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(scaff_cor)

n50_cor = ggplot(cactus_tree_info, aes(x=Scaffold.N50, y=InvertedBases, color=InvertedBases)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Inverted bases', option = "C") +
  xlab("Scaffold N50") +
  ylab("Inverted bases") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(n50_cor)

tree_leg = get_legend(tree_fig)

p_right = plot_grid(bl_cor, scaff_cor, n50_cor, nrow=3)
p_top = plot_grid(tree_fig + theme(legend.position="none"), p_right , ncol=2, rel_widths=c(1,0.8))
p = plot_grid(p_top, tree_leg, nrow=2, rel_heights=c(1,0.1))

# tree_leg = get_legend(tree_fig)
# 
# p_top = plot_grid(NULL, bl_cor, tree_leg, nrow=3, rel_heights=c(0.2,1,0.3))
# p = plot_grid(tree_fig + theme(legend.position="none"), p_top, ncol=2)
print(p)
```

## Duplications

```{r duplications, out.width="90%", fig.align = "center", warning=FALSE, fig.height=5}

h = corecol(numcol=1, pal="wilke", offset=3)
l = corecol(numcol=1, offset=3)
# Colors

famcol = corecol(pal="trek", numcol=1, offset=2)
famoffset = 0.0275
famsize = 2

#cactus_tree_info$subs.per.site = cactus_tree_info$Subtitutions / cactus_tree_info$GenomeLength

tree_fig = ggtree(cactus_tree, size=0.8, ladderize=F, aes(color=cactus_tree_info$Duplications)) +
  #scale_color_continuous(low=l, high=h) +
  scale_color_viridis(name='Duplications', option = "C") +
  xlim(0, 0.25) +
  geom_tiplab(fontface='italic', size=2) +
  geom_text(label=ifelse(cactus_tree_info$node.type != "tip", cactus_tree_info$label, ""), hjust=-0.2, size=2) +
  geom_nodepoint(alpha=0.85, size=2) +
  #scale_color_manual(name='Include?', values=c("N"=corecol(pal="wilke", numcol=1,offset=1), "Y"=corecol(numcol=1, offset=1))) +
  #geom_text(aes(label=node), hjust=-.3, vjust=-.3, color="#ff6db6") +
  
  geom_cladelabel(node=21, label="Podocnemididae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=22, label="Pelomedusidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=42, label="Chelidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=3,  label="Carettochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=26, label="Trionychidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=18, label="Dermochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=40, label="Cheloniidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=14, label="Chelydridae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=15, label="Dermatemydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=13, label="Platysternidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=34, label="Emydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=30, label="Testudinidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=31, label="Geomydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  
  theme(legend.position="bottom",
        legend.title=element_text(size=10),
        legend.text=element_text(size=8))

tree_fig = rotateTurtleTree(tree_fig)

bl_cor = ggplot(cactus_tree_info, aes(x=BranchLength, y=Duplications, color=Duplications)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Duplications', option = "C") +
  xlab("Branch length") +
  ylab("Duplications") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(bl_cor)

scaff_cor = ggplot(cactus_tree_info, aes(x=Scaffolds, y=Duplications, color=Duplications)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Duplications', option = "C") +
  xlab("# Scaffolds") +
  ylab("Duplications") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(scaff_cor)

n50_cor = ggplot(cactus_tree_info, aes(x=Scaffold.N50, y=Duplications, color=Duplications)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Duplications', option = "C") +
  xlab("Scaffold N50") +
  ylab("Duplications") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(n50_cor)

tree_leg = get_legend(tree_fig)

p_right = plot_grid(bl_cor, scaff_cor, n50_cor, nrow=3)
p_top = plot_grid(tree_fig + theme(legend.position="none"), p_right , ncol=2, rel_widths=c(1,0.8))
p = plot_grid(p_top, tree_leg, nrow=2, rel_heights=c(1,0.1))

# tree_leg = get_legend(tree_fig)
# 
# p_top = plot_grid(NULL, bl_cor, tree_leg, nrow=3, rel_heights=c(0.2,1,0.3))
# p = plot_grid(tree_fig + theme(legend.position="none"), p_top, ncol=2)
print(p)
```

## Duplicated bases

```{r duplicated-bases, out.width="90%", fig.align = "center", warning=FALSE, fig.height=5}

h = corecol(numcol=1, pal="wilke", offset=3)
l = corecol(numcol=1, offset=3)
# Colors

famcol = corecol(pal="trek", numcol=1, offset=2)
famoffset = 0.0275
famsize = 2

#cactus_tree_info$subs.per.site = cactus_tree_info$Subtitutions / cactus_tree_info$GenomeLength

tree_fig = ggtree(cactus_tree, size=0.8, ladderize=F, aes(color=cactus_tree_info$DuplicatedBases)) +
  #scale_color_continuous(low=l, high=h) +
  scale_color_viridis(name='Duplicated bases', option = "C") +
  xlim(0, 0.25) +
  geom_tiplab(fontface='italic', size=2) +
  geom_text(label=ifelse(cactus_tree_info$node.type != "tip", cactus_tree_info$label, ""), hjust=-0.2, size=2) +
  geom_nodepoint(alpha=0.85, size=2) +
  #scale_color_manual(name='Include?', values=c("N"=corecol(pal="wilke", numcol=1,offset=1), "Y"=corecol(numcol=1, offset=1))) +
  #geom_text(aes(label=node), hjust=-.3, vjust=-.3, color="#ff6db6") +
  
  geom_cladelabel(node=21, label="Podocnemididae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=22, label="Pelomedusidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=42, label="Chelidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=3,  label="Carettochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=26, label="Trionychidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=18, label="Dermochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=40, label="Cheloniidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=14, label="Chelydridae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=15, label="Dermatemydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=13, label="Platysternidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=34, label="Emydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=30, label="Testudinidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=31, label="Geomydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  
  theme(legend.position="bottom",
        legend.title=element_text(size=10),
        legend.text=element_text(size=8))

tree_fig = rotateTurtleTree(tree_fig)

bl_cor = ggplot(cactus_tree_info, aes(x=BranchLength, y=DuplicatedBases, color=DuplicatedBases)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Duplicated bases', option = "C") +
  xlab("Branch length") +
  ylab("Duplicated bases") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(bl_cor)

scaff_cor = ggplot(cactus_tree_info, aes(x=Scaffolds, y=DuplicatedBases, color=DuplicatedBases)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Duplicated bases', option = "C") +
  xlab("# Scaffolds") +
  ylab("Duplicated bases") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(scaff_cor)

n50_cor = ggplot(cactus_tree_info, aes(x=Scaffold.N50, y=DuplicatedBases, color=DuplicatedBases)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Duplicated bases', option = "C") +
  xlab("Scaffold N50") +
  ylab("Duplicated bases") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(n50_cor)

tree_leg = get_legend(tree_fig)

p_right = plot_grid(bl_cor, scaff_cor, n50_cor, nrow=3)
p_top = plot_grid(tree_fig + theme(legend.position="none"), p_right , ncol=2, rel_widths=c(1,0.8))
p = plot_grid(p_top, tree_leg, nrow=2, rel_heights=c(1,0.1))

# tree_leg = get_legend(tree_fig)
# 
# p_top = plot_grid(NULL, bl_cor, tree_leg, nrow=3, rel_heights=c(0.2,1,0.3))
# p = plot_grid(tree_fig + theme(legend.position="none"), p_top, ncol=2)
print(p)
```

## Transpositions

```{r transpositions, out.width="90%", fig.align = "center", warning=FALSE, fig.height=5}

h = corecol(numcol=1, pal="wilke", offset=3)
l = corecol(numcol=1, offset=3)
# Colors

famcol = corecol(pal="trek", numcol=1, offset=2)
famoffset = 0.0275
famsize = 2

#cactus_tree_info$subs.per.site = cactus_tree_info$Subtitutions / cactus_tree_info$GenomeLength

tree_fig = ggtree(cactus_tree, size=0.8, ladderize=F, aes(color=cactus_tree_info$Transpositions)) +
  #scale_color_continuous(low=l, high=h) +
  scale_color_viridis(name='Transpositions', option = "C") +
  xlim(0, 0.25) +
  geom_tiplab(fontface='italic', size=2) +
  geom_text(label=ifelse(cactus_tree_info$node.type != "tip", cactus_tree_info$label, ""), hjust=-0.2, size=2) +
  geom_nodepoint(alpha=0.85, size=2) +
  #scale_color_manual(name='Include?', values=c("N"=corecol(pal="wilke", numcol=1,offset=1), "Y"=corecol(numcol=1, offset=1))) +
  #geom_text(aes(label=node), hjust=-.3, vjust=-.3, color="#ff6db6") +
  
  geom_cladelabel(node=21, label="Podocnemididae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=22, label="Pelomedusidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=42, label="Chelidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=3,  label="Carettochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=26, label="Trionychidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=18, label="Dermochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=40, label="Cheloniidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=14, label="Chelydridae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=15, label="Dermatemydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=13, label="Platysternidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=34, label="Emydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=30, label="Testudinidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=31, label="Geomydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  
  theme(legend.position="bottom",
        legend.title=element_text(size=10),
        legend.text=element_text(size=8))

tree_fig = rotateTurtleTree(tree_fig)

bl_cor = ggplot(cactus_tree_info, aes(x=BranchLength, y=Transpositions, color=Transpositions)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Transpositions', option = "C") +
  xlab("Branch length") +
  ylab("Transpositions") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(bl_cor)

scaff_cor = ggplot(cactus_tree_info, aes(x=Scaffolds, y=Transpositions, color=Transpositions)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Transpositions', option = "C") +
  xlab("# Scaffolds") +
  ylab("Transpositions") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(scaff_cor)

n50_cor = ggplot(cactus_tree_info, aes(x=Scaffold.N50, y=Transpositions, color=Transpositions)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Transpositions', option = "C") +
  xlab("Scaffold N50") +
  ylab("Transpositions") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(n50_cor)

tree_leg = get_legend(tree_fig)

p_right = plot_grid(bl_cor, scaff_cor, n50_cor, nrow=3)
p_top = plot_grid(tree_fig + theme(legend.position="none"), p_right , ncol=2, rel_widths=c(1,0.8))
p = plot_grid(p_top, tree_leg, nrow=2, rel_heights=c(1,0.1))

# tree_leg = get_legend(tree_fig)
# 
# p_top = plot_grid(NULL, bl_cor, tree_leg, nrow=3, rel_heights=c(0.2,1,0.3))
# p = plot_grid(tree_fig + theme(legend.position="none"), p_top, ncol=2)
print(p)
```

## Transposed bases

```{r transposed-bases, out.width="90%", fig.align = "center", warning=FALSE, fig.height=5}

h = corecol(numcol=1, pal="wilke", offset=3)
l = corecol(numcol=1, offset=3)
# Colors

famcol = corecol(pal="trek", numcol=1, offset=2)
famoffset = 0.0275
famsize = 2

#cactus_tree_info$subs.per.site = cactus_tree_info$Subtitutions / cactus_tree_info$GenomeLength

tree_fig = ggtree(cactus_tree, size=0.8, ladderize=F, aes(color=cactus_tree_info$TranspositionBases)) +
  #scale_color_continuous(low=l, high=h) +
  scale_color_viridis(name='Transposed bases', option = "C") +
  xlim(0, 0.25) +
  geom_tiplab(fontface='italic', size=2) +
  geom_text(label=ifelse(cactus_tree_info$node.type != "tip", cactus_tree_info$label, ""), hjust=-0.2, size=2) +
  geom_nodepoint(alpha=0.85, size=2) +
  #scale_color_manual(name='Include?', values=c("N"=corecol(pal="wilke", numcol=1,offset=1), "Y"=corecol(numcol=1, offset=1))) +
  #geom_text(aes(label=node), hjust=-.3, vjust=-.3, color="#ff6db6") +
  
  geom_cladelabel(node=21, label="Podocnemididae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=22, label="Pelomedusidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=42, label="Chelidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=3,  label="Carettochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=26, label="Trionychidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=18, label="Dermochelyidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=40, label="Cheloniidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=14, label="Chelydridae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=15, label="Dermatemydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=13, label="Platysternidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=34, label="Emydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=30, label="Testudinidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  geom_cladelabel(node=31, label="Geomydidae", align=T, color=famcol, offset=famoffset, fontsize=famsize) +
  
  theme(legend.position="bottom",
        legend.title=element_text(size=10),
        legend.text=element_text(size=8))

tree_fig = rotateTurtleTree(tree_fig)

bl_cor = ggplot(cactus_tree_info, aes(x=BranchLength, y=TranspositionBases, color=TranspositionBases)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Transposed bases', option = "C") +
  xlab("Branch length") +
  ylab("Transposed bases") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(bl_cor)

scaff_cor = ggplot(cactus_tree_info, aes(x=Scaffolds, y=TranspositionBases, color=TranspositionBases)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Transposed bases', option = "C") +
  xlab("# Scaffolds") +
  ylab("Transposed bases") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(scaff_cor)

n50_cor = ggplot(cactus_tree_info, aes(x=Scaffold.N50, y=TranspositionBases, color=TranspositionBases)) +
  geom_point(size=2, alpha=0.5) +
  #geom_smooth(method="lm", se=F, formula=y~log10(x)) +
  geom_smooth(method="lm", se=F, linetype="dashed", color="#333333") +
  scale_color_viridis(name='Transposed bases', option = "C") +
  xlab("Scaffold N50") +
  ylab("Transposed bases") +
  bartheme() +
  theme(legend.position="none",
        axis.title=element_text(size=10),
        axis.text=element_text(size=8),
        plot.margin=unit(c(0.5,2,0,0), "cm"))
#print(n50_cor)

tree_leg = get_legend(tree_fig)

p_right = plot_grid(bl_cor, scaff_cor, n50_cor, nrow=3)
p_top = plot_grid(tree_fig + theme(legend.position="none"), p_right , ncol=2, rel_widths=c(1,0.8))
p = plot_grid(p_top, tree_leg, nrow=2, rel_heights=c(1,0.1))

# tree_leg = get_legend(tree_fig)
# 
# p_top = plot_grid(NULL, bl_cor, tree_leg, nrow=3, rel_heights=c(0.2,1,0.3))
# p = plot_grid(tree_fig + theme(legend.position="none"), p_top, ncol=2)
print(p)
```





[< Back to samples](index.html)